{% extends "base.html" %}

{% block title %}Bảng điều khiển Ứng viên{% endblock %}

{% block content %}
<div class="candidate-dashboard">
    <!-- CỘT BÊN TRÁI -->
    <div class="dashboard-sidebar">
        <div class="profile-card">
            <div class="profile-avatar-wrapper">
                <img id="profile-avatar-img" src="{{ current_user.avatar or url_for('static', filename='image/default_avatar.jpg') }}" alt="Avatar">
                <button id="btn-upload-avatar" class="btn-change-avatar"><i class="fas fa-camera"></i></button>
            </div>
            <h4 id="profile-fullname">{{ profile.full_name }}</h4>
            <p>{{ current_user.email }}</p>
            <button id="btn-edit-profile" class="btn btn-outline">Chỉnh sửa hồ sơ</button>
        </div>
        <div class="dashboard-nav">
            <a href="#" class="nav-item active" data-tab="overview">
                <i class="fas fa-user"></i> Tổng quan
            </a>
            <a href="#" class="nav-item" data-tab="cvs">
                <i class="fas fa-file-alt"></i> CV của tôi
            </a>
            <a href="#" class="nav-item" data-tab="applied">
                <i class="fas fa-check-square"></i> Việc làm đã ứng tuyển
            </a>
        </div>
    </div>

    <!-- CỘT BÊN PHẢI -->
    <div class="dashboard-content">
        <!-- Tab Tổng quan -->
        <div class="tab-pane active" id="overview">
            <h3>Thông tin cá nhân</h3>
            <div class="info-grid">
                <div><strong>Họ và tên:</strong> <span id="info-fullname">{{ profile.full_name }}</span></div>
                <div><strong>Email:</strong> <span>{{ user.email }}</span></div>
                <div><strong>Số điện thoại:</strong> <span id="info-phone">{{ profile.phone_number or 'Chưa cập nhật' }}</span></div>
                <div><strong>Địa chỉ:</strong> <span id="info-address">{{ profile.address or 'Chưa cập nhật' }}</span></div>
            </div>
        </div>
        <!-- Tab CV -->
        <div class="tab-pane" id="cvs">
            <h3>Quản lý CV</h3>
            <div id="cv-management-content"
                 data-url="{{ url_for('candidate.manage_cvs') }}">
                Đang tải danh sách CV...
            </div>
        </div>
        <!-- Tab Việc làm đã ứng tuyển -->
        <div class="tab-pane" id="applied">
            <h3>Việc làm đã ứng tuyển</h3>
            <div id="applied-jobs-list">
                <!-- Danh sách việc làm sẽ được JS render vào đây -->
            </div>
        </div>
    </div>
</div>

<!-- Modal Chỉnh sửa thông tin (ẩn) -->
<div id="edit-profile-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Chỉnh sửa thông tin cá nhân</h3>
            <span id="close-modal-btn" class="close-btn">&times;</span>
        </div>
        <div class="modal-body">
            <form id="edit-profile-form">
                <div class="form-group">
                    <label for="edit-fullname">Họ và tên</label>
                    <input type="text" id="edit-fullname" name="full_name" class="form-control" value="{{ profile.full_name or '' }}" required>
                </div>
                <div class="form-group">
                    <label for="edit-phone">Số điện thoại</label>
                    <input type="text" id="edit-phone" name="phone_number" class="form-control" value="{{ profile.phone_number or '' }}">
                </div>
                <div class="form-group">
                    <label for="edit-address">Địa chỉ</label>
                    <input type="text" id="edit-address" name="address" class="form-control" value="{{ profile.address or '' }}">
                </div>
                <div class="form-group">
                    <label for="edit-linkedin">LinkedIn URL</label>
                    <input type="url" id="edit-linkedin" name="linkedin_url" class="form-control" value="{{ profile.linkedin_url or '' }}">
                </div>
                <div id="form-message" class="mt-3"></div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Lưu thay đổi</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/profile_dashboard.js') }}"></script>
{% endblock %}